var __awaiter=this&&this.__awaiter||function(e,s,r,c){return new(r=r||Promise)(function(n,t){function o(e){try{a(c.next(e))}catch(e){t(e)}}function i(e){try{a(c.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,i)}a((c=c.apply(e,s||[])).next())})};let isOpenLogin=!1,isOpenSignin=!1;function validateAccount(){return __awaiter(this,void 0,void 0,function*(){var e=document.getElementById("login_userID"),t=document.getElementById("login_passID"),n=document.getElementById("loginWarningTxt");try{var o,i,a=yield(yield fetch("/login",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e.value,password:t.value})})).json();"success"===a.message?(document.getElementById("processingDiv").style.display="flex",o=yield setCookie(a.username,"loggedIn"),i=CryptoJS.AES.decrypt(localStorage.getItem("tempPlayerName"),"tempPlayerName").toString(CryptoJS.enc.Utf8),o.status&&i&&(socket.emit("redirectToBase",i),socket.emit("playerCount",1),window.location.href="/Game/Base/"+replaceSlashWithUnderscore(o.encryptUser),localStorage.removeItem("tempPlayerName"))):n.innerText=a.message}catch(e){console.log(e)}})}function validateCreateAccount(){return __awaiter(this,void 0,void 0,function*(){var e=document.getElementById("signin_userID"),t=document.getElementById("signin_passID"),n=document.getElementById("signin_confirmPassID"),o=document.getElementById("signinWarningTxt");try{var i,a,s=yield(yield fetch("/signin",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"},body:JSON.stringify({username:e.value,confirmPass:n.value,password:t.value})})).json();"success"===s.message?(document.getElementById("processingDiv").style.display="flex",i=yield setCookie(s.username,"loggedIn"),a=CryptoJS.AES.decrypt(localStorage.getItem("tempPlayerName"),"tempPlayerName").toString(CryptoJS.enc.Utf8),i.status&&a&&(document.getElementById("processingDiv").style.display="none",socket.emit("redirectToBase",a),socket.emit("playerCount",1),window.location.href="/Game/Base/"+replaceSlashWithUnderscore(i.encryptUser),localStorage.removeItem("tempPlayerName"))):o.innerText=s.message}catch(e){console.log(e)}})}document.addEventListener("keypress",function(e){"Enter"===e.key&&(isOpenLogin&&validateAccount(),isOpenSignin)&&validateCreateAccount()}),socket.emit("logoutPlayer");